<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Past Appointments - Bio Revive by SkinEnvy</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="../../js/lib/jquery-3.3.1.min.js"></script>
    <script src="../../js/lib/ZohoEmbededAppSDK.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'theme-bg-primary': 'var(--bg-primary)',
                        'theme-bg-secondary': 'var(--bg-secondary)',
                        'theme-bg-accent': 'var(--bg-accent)',
                        'theme-text-primary': 'var(--text-primary)',
                        'theme-text-secondary': 'var(--text-secondary)',
                        'theme-border': 'var(--border-color)',
                        'theme-primary': 'var(--color-primary)',
                        'theme-secondary': 'var(--color-secondary)',
                        'theme-accent': 'var(--color-accent)',
                        primary: {
                            50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a',
                        },
                        success: {
                            50: '#f0fdf4', 100: '#dcfce7', 200: '#bbf7d0', 300: '#86efac', 400: '#4ade80', 500: '#22c55e', 600: '#16a34a', 700: '#15803d', 800: '#166534', 900: '#14532d',
                        },
                        warning: {
                            50: '#fff7ed', 100: '#ffedd5', 200: '#fed7aa', 300: '#fdba74', 400: '#fb923c', 500: '#f97316', 600: '#ea580c', 700: '#c2410c', 800: '#9a3412', 900: '#7c2d12',
                        },
                        danger: {
                            50: '#fef2f2', 100: '#fee2e2', 200: '#fecaca', 300: '#fca5a5', 400: '#f87171', 500: '#ef4444', 600: '#dc2626', 700: '#b91c1c', 800: '#991b1b', 900: '#7f1d1d',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1)',
                        'card-hover': '0 4px 6px -1px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-accent: #f3f4f6;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --border-color: #e5e7eb;
            --color-primary: #3b82f6;
            --color-secondary: #60a5fa;
            --color-accent: #2563eb;
        }

        html.dark {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --bg-accent: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --border-color: #374151;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .animate-fade-in { animation: fadeIn 0.6s ease-out; }
        .animate-pulse-custom { animation: pulse 2s infinite; }
        .animate-spin { animation: spin 1s linear infinite; }
        
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        .loading-placeholder {
            background: linear-gradient(90deg, var(--bg-accent) 25%, var(--bg-primary) 50%, var(--bg-accent) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .card-hover-effect {
            transition: all 0.2s ease;
        }
        
        .card-hover-effect:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        html.dark .card-hover-effect:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        .appointment-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        .appointment-card:hover {
            border-color: var(--color-primary);
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-completed {
            background-color: #dcfce7;
            color: #166534;
        }

        .status-cancelled {
            background-color: #fee2e2;
            color: #991b1b;
        }

        html.dark .status-completed {
            background-color: #166534;
            color: #dcfce7;
        }

        html.dark .status-cancelled {
            background-color: #991b1b;
            color: #fee2e2;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="bg-theme-bg-secondary text-theme-text-primary font-sans antialiased min-h-screen transition-colors duration-300 scrollbar-hide">
    <div class="flex h-screen overflow-hidden">
        <!-- Modern Sidebar -->
        <div class="hidden lg:flex lg:flex-shrink-0">
            <div class="flex flex-col w-72 bg-theme-bg-primary border-r border-theme-border">
                <div class="flex items-center h-16 px-6 border-b border-theme-border">
                    <div class="flex items-center space-x-4">
                        <div class="w-10 h-10 rounded-lg bg-theme-primary flex items-center justify-center">
                            <span class="material-icons text-white text-xl">spa</span>
                        </div>
                        <div>
                            <h2 class="text-lg font-bold text-theme-text-primary">Bio Revive</h2>
                            <p class="text-xs text-theme-text-secondary">by SkinEnvy</p>
                        </div>
                    </div>
                </div>
                
                <div class="flex-1 flex flex-col pt-6 pb-4 overflow-y-auto scrollbar-hide">
                    <div class="px-6">
                        <h3 class="text-xs font-semibold uppercase tracking-wider text-theme-text-secondary mb-4">Analytics</h3>
                    </div>
                    <nav class="mt-2 flex-1 px-4 space-y-1">
                        <a href="test.html" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">dashboard</span>
                            Analytics Dashboard
                        </a>
                        <a href="#" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg bg-theme-bg-accent text-theme-primary border-l-4 border-theme-primary">
                            <span class="material-icons mr-3 text-theme-primary text-xl">history</span>
                            Past Appointments
                        </a>
                        <a href="appointment_types.html" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">spa</span>
                            Services
                        </a>
                        <a href="#" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">people</span>
                            Clients
                        </a>
                        <a href="#" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">analytics</span>
                            Reports
                        </a>
                    </nav>

                    <div class="px-6 mt-8">
                        <h3 class="text-xs font-semibold uppercase tracking-wider text-theme-text-secondary mb-4">Settings</h3>
                    </div>
                    <nav class="mt-2 flex-1 px-4 space-y-1">
                        <a href="#" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">person</span>
                            Profile
                        </a>
                        <a href="#" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">settings</span>
                            Settings
                        </a>
                        <a href="#" class="group flex items-center px-4 py-3 text-sm font-medium rounded-lg text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons mr-3 text-theme-text-secondary text-xl">help</span>
                            Help & Support
                        </a>
                    </nav>
                </div>
                
                <!-- User Profile Section -->
                <div class="p-4 border-t border-theme-border">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-lg bg-theme-primary/20 flex items-center justify-center text-theme-primary font-medium">
                            PK
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium text-theme-text-primary truncate">Prem Anand K</p>
                            <div class="flex items-center mt-1">
                                <div class="h-2 w-2 rounded-full bg-success-500 mr-2"></div>
                                <p class="text-xs text-theme-text-secondary">Online</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex flex-col flex-1 overflow-hidden">
            <!-- Top Navigation -->
            <div class="flex items-center h-16 bg-theme-bg-primary border-b border-theme-border px-4 lg:px-8">
                <button class="p-2 rounded-lg text-theme-text-secondary lg:hidden hover:bg-theme-bg-accent" onclick="toggleMobileMenu()">
                    <span class="material-icons">menu</span>
                </button>
                
                <div class="flex-1 flex justify-center lg:justify-end max-w-lg ml-auto">
                    <div class="w-full">
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span class="material-icons text-theme-text-secondary">search</span>
                            </div>
                            <input type="text" id="searchInput" placeholder="Search by client name, service, phone..." class="block w-full pl-10 pr-4 py-2 rounded-lg border border-theme-border bg-theme-bg-accent focus:outline-none focus:ring-2 focus:ring-theme-primary focus:border-transparent text-sm text-theme-text-primary placeholder-theme-text-secondary">
                        </div>
                    </div>
                </div>
                
                <div class="ml-4 flex items-center space-x-2">
                    <button onclick="refreshPastAppointments()" id="refreshBtn" class="p-2 rounded-lg text-theme-text-secondary hover:bg-theme-bg-accent" title="Refresh Appointments">
                        <span class="material-icons">refresh</span>
                    </button>
                    <button onclick="exportPastAppointments()" class="p-2 rounded-lg text-theme-text-secondary hover:bg-theme-bg-accent" title="Export Report">
                        <span class="material-icons">download</span>
                    </button>
                    <button onclick="openAnonymousScheduling()" class="p-2 rounded-lg text-theme-text-secondary hover:bg-theme-bg-accent" title="Schedule Appointment">
                        <span class="material-icons">calendar_today</span>
                    </button>
                    <button onclick="showHelpModal()" class="p-2 rounded-lg text-theme-text-secondary hover:bg-theme-bg-accent" title="Help & Information">
                        <span class="material-icons">help_outline</span>
                    </button>
                </div>
            </div>

            <!-- Page Content -->
            <main class="flex-1 overflow-auto p-6 bg-theme-bg-secondary scrollbar-hide">
                <!-- Page Header -->
                <div class="mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-theme-text-primary">Past Appointments</h1>
                            <p class="text-theme-text-secondary mt-2">View and manage appointments</p>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div id="appointmentStats" class="flex items-center space-x-4 text-sm">
                                <div class="text-center">
                                    <p class="font-bold text-theme-text-primary" id="totalAppointments">-</p>
                                    <p class="text-theme-text-secondary">Total</p>
                                </div>
                                <div class="text-center">
                                    <p class="font-bold text-green-600" id="completedAppointments">-</p>
                                    <p class="text-theme-text-secondary">Completed</p>
                                </div>
                                <div class="text-center">
                                    <p class="font-bold text-red-600" id="cancelledAppointments">-</p>
                                    <p class="text-theme-text-secondary">Cancelled</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="bg-theme-bg-primary rounded-lg border border-theme-border p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-theme-text-secondary mb-2">Date Range</label>
                            <select id="dateRangeFilter" class="w-full px-3 py-2 border border-theme-border rounded-lg focus:ring-2 focus:ring-theme-primary focus:border-transparent text-sm bg-theme-bg-secondary text-theme-text-primary">
                                <option value="all">All Time</option>
                                <option value="today">Today</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                                <option value="quarter">This Quarter</option>
                                <option value="year">This Year</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-theme-text-secondary mb-2">Service Type</label>
                            <select id="serviceFilter" class="w-full px-3 py-2 border border-theme-border rounded-lg focus:ring-2 focus:ring-theme-primary focus:border-transparent text-sm bg-theme-bg-secondary text-theme-text-primary">
                                <option value="all">All Services</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-theme-text-secondary mb-2">Status</label>
                            <select id="statusFilter" class="w-full px-3 py-2 border border-theme-border rounded-lg focus:ring-2 focus:ring-theme-primary focus:border-transparent text-sm bg-theme-bg-secondary text-theme-text-primary">
                                <option value="all">All Status</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-theme-text-secondary mb-2">Calendar</label>
                            <select id="calendarFilter" class="w-full px-3 py-2 border border-theme-border rounded-lg focus:ring-2 focus:ring-theme-primary focus:border-transparent text-sm bg-theme-bg-secondary text-theme-text-primary">
                                <option value="all">All Calendars</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="loading-placeholder h-32 rounded-lg"></div>
                        <div class="loading-placeholder h-32 rounded-lg"></div>
                        <div class="loading-placeholder h-32 rounded-lg"></div>
                        <div class="loading-placeholder h-32 rounded-lg"></div>
                        <div class="loading-placeholder h-32 rounded-lg"></div>
                        <div class="loading-placeholder h-32 rounded-lg"></div>
                    </div>
                </div>

                <!-- Appointments Grid -->
                <div id="appointmentsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Appointments will be dynamically loaded here -->
                </div>

                <!-- No Results State -->
                <div id="noResultsState" class="hidden text-center py-12">
                    <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-theme-bg-accent flex items-center justify-center">
                        <span class="material-icons text-4xl text-theme-text-secondary">search_off</span>
                    </div>
                    <h3 class="text-xl font-semibold text-theme-text-primary mb-2">No appointments found</h3>
                    <p class="text-theme-text-secondary">Try adjusting your search criteria or filters.</p>
                </div>

                <!-- Appointment Details Modal -->
                <div id="appointmentModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
                    <div class="flex items-center justify-center min-h-screen p-4">
                        <div class="bg-theme-bg-primary rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                            <div class="p-6 border-b border-theme-border">
                                <div class="flex items-center justify-between">
                                    <h2 class="text-xl font-bold text-theme-text-primary">Appointment Details</h2>
                                    <button onclick="closeAppointmentModal()" class="p-2 rounded-lg text-theme-text-secondary hover:text-theme-text-primary hover:bg-theme-bg-accent">
                                        <span class="material-icons">close</span>
                                    </button>
                                </div>
                            </div>
                            <div id="modalContent" class="p-6">
                                <!-- Modal content will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobileNav" class="lg:hidden fixed bottom-0 left-0 right-0 bg-theme-bg-primary border-t border-theme-border px-4 py-2 z-50">
        <div class="flex justify-around items-center">
            <a href="test.html" class="flex flex-col items-center p-2 text-theme-text-secondary">
                <span class="material-icons text-lg">dashboard</span>
                <span class="text-xs mt-1">Analytics</span>
            </a>
            <a href="#" class="flex flex-col items-center p-2 text-theme-primary">
                <span class="material-icons text-lg">history</span>
                <span class="text-xs mt-1 font-medium">Past</span>
            </a>
            <a href="appointment_types.html" class="flex flex-col items-center p-2 text-theme-text-secondary">
                <span class="material-icons text-lg">spa</span>
                <span class="text-xs mt-1">Services</span>
            </a>
            <a href="#" class="flex flex-col items-center p-2 text-theme-text-secondary">
                <span class="material-icons text-lg">person</span>
                <span class="text-xs mt-1">Profile</span>
            </a>
        </div>
    </div>

    <!-- Theme Switcher -->
    <div id="theme-switcher-container"></div>

    <!-- Anonymous Scheduling Modal -->
    <div id="anonymousSchedulingModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-theme-bg-primary rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden">
                <div class="p-6 border-b border-theme-border bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20">
                    <div class="flex items-center justify-between">
                        <h2 class="text-2xl font-bold text-theme-text-primary">Schedule Appointment</h2>
                        <button onclick="closeAnonymousScheduling()" class="p-2 rounded-full text-theme-text-secondary hover:text-theme-text-primary hover:bg-theme-bg-accent">
                            <span class="material-icons">close</span>
                        </button>
                    </div>
                </div>
                <div class="relative" style="height: 700px;">
                    <div id="schedulingLoader" class="absolute inset-0 bg-theme-bg-primary flex items-center justify-center z-10">
                        <div class="text-center">
                            <div class="w-16 h-16 border-4 border-theme-primary border-t-transparent rounded-full animate-spin mb-4 mx-auto"></div>
                            <p class="text-theme-text-primary font-medium">Loading scheduling page...</p>
                        </div>
                    </div>
                    <iframe id="schedulingFrame" src="" width="100%" height="100%" frameborder="0" class="absolute inset-0" style="display: none;"></iframe>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables and configuration
        let pastAppointments = [];
        let filteredAppointments = [];
        let originalSearchResults = []; // For search functionality
        let isLoading = false;

        // Theme Configuration
        const themeConfig = {
            colors: {
                blue: { primary: '#3b82f6', secondary: '#60a5fa', accent: '#2563eb' },
                purple: { primary: '#8b5cf6', secondary: '#a78bfa', accent: '#7c3aed' },
                green: { primary: '#10b981', secondary: '#34d399', accent: '#059669' },
                orange: { primary: '#f97316', secondary: '#fb923c', accent: '#ea580c' },
                red: { primary: '#ef4444', secondary: '#f87171', accent: '#dc2626' },
                teal: { primary: '#14b8a6', secondary: '#5eead4', accent: '#0d9488' },
                pink: { primary: '#ec4899', secondary: '#f472b6', accent: '#db2777' },
                indigo: { primary: '#6366f1', secondary: '#818cf8', accent: '#4f46e5' }
            }
        };

        // Theme Functions
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            localStorage.setItem('dashboard_theme', theme);
        }

        function applyThemeColor(colorName) {
            const color = themeConfig.colors[colorName];
            if (!color) return;

            const root = document.documentElement;
            root.style.setProperty('--color-primary', color.primary);
            root.style.setProperty('--color-secondary', color.secondary);
            root.style.setProperty('--color-accent', color.accent);
            localStorage.setItem('dashboard_theme_color', colorName);
            addThemeSwitcher();
        }

        function toggleTheme() {
            const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
            applyTheme(newTheme);
            addThemeSwitcher();
        }
        
        function initializeTheme() {
            const savedTheme = localStorage.getItem('dashboard_theme') || 'light';
            const savedColor = localStorage.getItem('dashboard_theme_color') || 'blue';
            applyTheme(savedTheme);
            applyThemeColor(savedColor);
        }

        function addThemeSwitcher() {
            const container = document.getElementById('theme-switcher-container');
            if (!container) return;
            
            const isDark = document.documentElement.classList.contains('dark');
            const currentColor = localStorage.getItem('dashboard_theme_color') || 'blue';

            container.innerHTML = `
                <div class="fixed bottom-5 right-5 z-50">
                    <div id="theme-menu" class="absolute bottom-full right-0 mb-2 w-56 bg-theme-bg-primary rounded-lg shadow-2xl border border-theme-border p-4 z-50 hidden transition-all duration-300 opacity-0 -translate-y-2">
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium text-theme-text-primary">Theme Mode</span>
                                <button onclick="toggleTheme()" class="relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-theme-primary focus:ring-offset-2 focus:ring-offset-theme-bg-primary ${isDark ? 'bg-theme-primary' : 'bg-gray-300'}">
                                    <span class="sr-only">Toggle theme</span>
                                    <span class="material-icons text-xs absolute transition-opacity duration-200 ${isDark ? 'right-1 opacity-100' : 'right-1 opacity-0'}" style="color: #fbbf24;">dark_mode</span>
                                    <span class="material-icons text-xs absolute transition-opacity duration-200 ${!isDark ? 'left-1 opacity-100' : 'left-1 opacity-0'}" style="color: #f59e0b;">light_mode</span>
                                    <span class="inline-block w-4 h-4 transform transition-transform duration-200 bg-white rounded-full shadow ${isDark ? 'translate-x-6' : 'translate-x-1'}"></span>
                                </button>
                            </div>
                            <div class="space-y-2">
                                <span class="text-sm font-medium text-theme-text-primary">Color Theme</span>
                                <div class="grid grid-cols-4 gap-2">
                                    ${Object.keys(themeConfig.colors).map(name => `
                                        <button onclick="applyThemeColor('${name}')" 
                                                class="relative w-8 h-8 rounded-full transition-all duration-200 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-theme-primary focus:ring-offset-theme-bg-primary ${currentColor === name ? 'ring-2 ring-offset-2 ring-white ring-offset-theme-bg-primary scale-110' : ''}"
                                                style="background-color: ${themeConfig.colors[name].primary}"
                                                title="${name.charAt(0).toUpperCase() + name.slice(1)}">
                                            ${currentColor === name ? '<span class="absolute inset-0 flex items-center justify-center"><span class="material-icons text-white text-sm">check</span></span>' : ''}
                                        </button>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                     <button id="theme-menu-button" class="bg-theme-primary text-white rounded-full p-3 shadow-lg hover:shadow-xl hover:bg-theme-accent transition-all duration-300 flex items-center justify-center transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-theme-primary focus:ring-offset-2 focus:ring-offset-theme-bg-secondary">
                        <span class="material-icons">palette</span>
                    </button>
                </div>
            `;

            const menuButton = document.getElementById('theme-menu-button');
            const themeMenu = document.getElementById('theme-menu');
            
            if (menuButton && themeMenu) {
                menuButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (themeMenu.classList.contains('hidden')) {
                        themeMenu.classList.remove('hidden');
                        setTimeout(() => {
                            themeMenu.classList.remove('opacity-0', '-translate-y-2');
                        }, 10);
                    } else {
                        themeMenu.classList.add('opacity-0', '-translate-y-2');
                        setTimeout(() => {
                            themeMenu.classList.add('hidden');
                        }, 300);
                    }
                });

                document.addEventListener('click', (e) => {
                    if (!themeMenu.classList.contains('hidden') && !themeMenu.contains(e.target) && !menuButton.contains(e.target)) {
                        themeMenu.classList.add('opacity-0', '-translate-y-2');
                        setTimeout(() => {
                            themeMenu.classList.add('hidden');
                        }, 300);
                    }
                });
            }
        }

        // Initialize the page
        document.addEventListener("DOMContentLoaded", function() {
            console.log('Page loaded, initializing...');
            initializeTheme();
            addThemeSwitcher();
            
            // Initialize without ZOHO dependency for testing
            initializePage();
            
            // Try ZOHO initialization but don't depend on it
            try {
                ZOHO.embeddedApp.init()
                    .then(function() {
                        console.log("ZOHO SDK initialized successfully");
                    })
                    .catch(function(error) {
                        console.log("ZOHO SDK not available, continuing without it");
                    });
            } catch (error) {
                console.log("ZOHO SDK not loaded, continuing without it");
            }
        });

        // Initialize page functionality
        function initializePage() {
            console.log('Initializing page functionality...');
            loadDataFromLocalStorage();
            setupEventListeners();
            populateFilters();
            applyFilters(); // This will render appointments
            updateStats();
        }

        // Load data from localStorage
        function loadDataFromLocalStorage() {
            try {
                console.log('Loading data from localStorage...');
                
                // Get data from localStorage
                const storedData = localStorage.getItem('pastAppointments');
                console.log('Raw stored data:', storedData ? 'Found data' : 'No data found');
                
                if (storedData) {
                    const parsedData = JSON.parse(storedData);
                    console.log('Parsed data type:', Array.isArray(parsedData) ? 'Array' : typeof parsedData);
                    console.log('Parsed data length/size:', Array.isArray(parsedData) ? parsedData.length : Object.keys(parsedData).length);
                    
                    if (Array.isArray(parsedData)) {
                        pastAppointments = parsedData;
                        console.log(`Loaded ${pastAppointments.length} appointments from localStorage`);
                    } else {
                        console.log('Data is not an array, trying to extract...');
                        pastAppointments = [];
                    }
                } else {
                    console.log('No data in localStorage, using empty array');
                    pastAppointments = [];
                }
                
                filteredAppointments = [...pastAppointments];
                originalSearchResults = [...pastAppointments];
                
                console.log('Final pastAppointments count:', pastAppointments.length);
                if (pastAppointments.length > 0) {
                    console.log('First appointment sample:', pastAppointments[0]);
                }
                
            } catch (error) {
                console.error('Error loading data from localStorage:', error);
                pastAppointments = [];
                filteredAppointments = [];
                originalSearchResults = [];
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            console.log('Setting up event listeners...');
            
            // Search functionality
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', handleSearch);
                console.log('Search listener added');
            }
            
            // Filter functionality
            const dateFilter = document.getElementById('dateRangeFilter');
            const serviceFilter = document.getElementById('serviceFilter');
            const statusFilter = document.getElementById('statusFilter');
            const calendarFilter = document.getElementById('calendarFilter');
            
            if (dateFilter) dateFilter.addEventListener('change', applyFilters);
            if (serviceFilter) serviceFilter.addEventListener('change', applyFilters);
            if (statusFilter) statusFilter.addEventListener('change', applyFilters);
            if (calendarFilter) calendarFilter.addEventListener('change', applyFilters);
            
            console.log('Filter listeners added');
        }

        // Populate filter dropdowns
        function populateFilters() {
            console.log('Populating filters...');
            
            if (pastAppointments.length === 0) {
                console.log('No appointments to populate filters with');
                return;
            }

            // Populate service filter
            const serviceFilter = document.getElementById('serviceFilter');
            if (serviceFilter) {
                const services = [...new Set(pastAppointments.map(apt => apt.type))].sort();
                serviceFilter.innerHTML = '<option value="all">All Services</option>';
                services.forEach(service => {
                    const option = document.createElement('option');
                    option.value = service;
                    option.textContent = service;
                    serviceFilter.appendChild(option);
                });
                console.log(`Added ${services.length} service options`);
            }

            // Populate calendar filter
            const calendarFilter = document.getElementById('calendarFilter');
            if (calendarFilter) {
                const calendars = [...new Set(pastAppointments.map(apt => apt.calendar))].sort();
                calendarFilter.innerHTML = '<option value="all">All Calendars</option>';
                calendars.forEach(calendar => {
                    const option = document.createElement('option');
                    option.value = calendar;
                    option.textContent = calendar;
                    calendarFilter.appendChild(option);
                });
                console.log(`Added ${calendars.length} calendar options`);
            }
        }

        // Handle search functionality
        function handleSearch(event) {
            const searchTerm = event.target.value.toLowerCase().trim();
            console.log('Searching for:', searchTerm);
            
            if (searchTerm === '') {
                originalSearchResults = [...pastAppointments];
            } else {
                originalSearchResults = pastAppointments.filter(appointment => {
                    const fullName = (appointment.firstName + ' ' + appointment.lastName).toLowerCase();
                    const type = appointment.type.toLowerCase();
                    const phone = appointment.phone ? appointment.phone.toLowerCase() : '';
                    const email = appointment.email ? appointment.email.toLowerCase() : '';
                    const calendar = appointment.calendar.toLowerCase();
                    
                    return fullName.includes(searchTerm) ||
                           type.includes(searchTerm) ||
                           phone.includes(searchTerm) ||
                           email.includes(searchTerm) ||
                           calendar.includes(searchTerm);
                });
            }
            
            console.log(`Search results: ${originalSearchResults.length} appointments`);
            applyFilters();
        }

        // Apply filters
        function applyFilters() {
            console.log('Applying filters...');
            
            const dateRange = document.getElementById('dateRangeFilter')?.value || 'all';
            const serviceType = document.getElementById('serviceFilter')?.value || 'all';
            const status = document.getElementById('statusFilter')?.value || 'all';
            const calendar = document.getElementById('calendarFilter')?.value || 'all';

            let filtered = [...originalSearchResults];
            console.log(`Starting with ${filtered.length} appointments after search`);

            // Date range filter - Note: treating all as valid regardless of date since these are "past" appointments
            if (dateRange !== 'all') {
                const now = new Date();
                let startDate;

                switch (dateRange) {
                    case 'today':
                        startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                        break;
                    case 'week':
                        startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                        break;
                    case 'month':
                        startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                        break;
                    case 'quarter':
                        const quarter = Math.floor(now.getMonth() / 3);
                        startDate = new Date(now.getFullYear(), quarter * 3, 1);
                        break;
                    case 'year':
                        startDate = new Date(now.getFullYear(), 0, 1);
                        break;
                }

                if (startDate) {
                    const originalLength = filtered.length;
                    filtered = filtered.filter(apt => {
                        const aptDate = new Date(apt.datetime);
                        return aptDate >= startDate;
                    });
                    console.log(`Date filter: ${originalLength} -> ${filtered.length}`);
                }
            }

            // Service type filter
            if (serviceType !== 'all') {
                const originalLength = filtered.length;
                filtered = filtered.filter(apt => apt.type === serviceType);
                console.log(`Service filter: ${originalLength} -> ${filtered.length}`);
            }

            // Status filter
            if (status !== 'all') {
                const originalLength = filtered.length;
                if (status === 'completed') {
                    filtered = filtered.filter(apt => !apt.canceled);
                } else if (status === 'cancelled') {
                    filtered = filtered.filter(apt => apt.canceled);
                }
                console.log(`Status filter: ${originalLength} -> ${filtered.length}`);
            }

            // Calendar filter
            if (calendar !== 'all') {
                const originalLength = filtered.length;
                filtered = filtered.filter(apt => apt.calendar === calendar);
                console.log(`Calendar filter: ${originalLength} -> ${filtered.length}`);
            }

            filteredAppointments = filtered;
            console.log(`Final filtered count: ${filteredAppointments.length}`);
            
            renderAppointments();
            updateStats();
        }

        // Render appointments
        function renderAppointments() {
            console.log(`Rendering ${filteredAppointments.length} appointments...`);
            
            const container = document.getElementById('appointmentsContainer');
            const noResultsState = document.getElementById('noResultsState');

            if (!container) {
                console.error('Appointments container not found!');
                return;
            }

            if (filteredAppointments.length === 0) {
                container.innerHTML = '';
                if (noResultsState) noResultsState.classList.remove('hidden');
                console.log('No appointments to display');
                return;
            }

            if (noResultsState) noResultsState.classList.add('hidden');

            // Sort appointments by date (newest first)
            const sortedAppointments = filteredAppointments.sort((a, b) => 
                new Date(b.datetime) - new Date(a.datetime)
            );

            container.innerHTML = sortedAppointments.map(appointment => 
                createAppointmentCard(appointment)
            ).join('');
            
            console.log('Appointments rendered successfully');
        }

        // Create appointment card HTML
        function createAppointmentCard(appointment) {
            const appointmentDate = new Date(appointment.datetime);
            const price = parseFloat(appointment.priceSold || appointment.price || 0);
            const isPaid = appointment.paid === 'yes';
            const isCancelled = appointment.canceled;
            
            return `
                <div class="appointment-card card-hover-effect rounded-lg p-6 cursor-pointer animate-fade-in" 
                     onclick="showAppointmentDetails('${appointment.id}')">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 rounded-full bg-theme-primary/20 flex items-center justify-center">
                                <span class="material-icons text-theme-primary">person</span>
                            </div>
                            <div>
                                <h3 class="font-semibold text-theme-text-primary">
                                    ${appointment.firstName} ${appointment.lastName}
                                </h3>
                                <p class="text-sm text-theme-text-secondary">
                                    ${appointment.phone || 'No phone'} ${appointment.email ? 'â€¢ ' + appointment.email : ''}
                                </p>
                            </div>
                        </div>
                        <span class="status-badge ${isCancelled ? 'status-cancelled' : 'status-completed'}">
                            ${isCancelled ? 'Cancelled' : 'Completed'}
                        </span>
                    </div>

                    <div class="space-y-3">
                        <div class="flex items-center space-x-2">
                            <span class="material-icons text-theme-text-secondary text-sm">spa</span>
                            <span class="text-sm font-medium text-theme-text-primary">${appointment.type}</span>
                        </div>
                        
                        <div class="flex items-center space-x-2">
                            <span class="material-icons text-theme-text-secondary text-sm">schedule</span>
                            <span class="text-sm text-theme-text-secondary">
                                ${appointmentDate.toLocaleDateString()} at ${appointment.time}
                            </span>
                        </div>

                        <div class="flex items-center space-x-2">
                            <span class="material-icons text-theme-text-secondary text-sm">location_on</span>
                            <span class="text-sm text-theme-text-secondary">${appointment.calendar}</span>
                        </div>

                        <div class="flex items-center justify-between pt-3 border-t border-theme-border">
                            <div class="flex items-center space-x-2">
                                <span class="material-icons text-theme-text-secondary text-sm">access_time</span>
                                <span class="text-sm text-theme-text-secondary">${appointment.duration} min</span>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-lg ${price > 0 ? 'text-green-600' : 'text-theme-text-secondary'}">
                                    $${price.toFixed(2)}
                                </p>
                                ${price > 0 ? `
                                    <p class="text-xs ${isPaid ? 'text-green-600' : 'text-red-600'}">
                                        ${isPaid ? 'Paid' : 'Unpaid'}
                                    </p>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Show appointment details modal
        function showAppointmentDetails(appointmentId) {
            const appointment = pastAppointments.find(apt => apt.id.toString() === appointmentId);
            if (!appointment) return;

            const modal = document.getElementById('appointmentModal');
            const modalContent = document.getElementById('modalContent');
            
            const appointmentDate = new Date(appointment.datetime);
            const createdDate = new Date(appointment.datetimeCreated);
            const price = parseFloat(appointment.priceSold || appointment.price || 0);
            const amountPaid = parseFloat(appointment.amountPaid || 0);
            
            modalContent.innerHTML = `
                <div class="space-y-6">
                    <!-- Client Information -->
                    <div>
                        <h3 class="text-lg font-semibold text-theme-text-primary mb-4 flex items-center">
                            <span class="material-icons mr-2">person</span>
                            Client Information
                        </h3>
                        <div class="bg-theme-bg-accent rounded-lg p-4 space-y-2">
                            <p><span class="font-medium">Name:</span> ${appointment.firstName} ${appointment.lastName}</p>
                            <p><span class="font-medium">Phone:</span> ${appointment.phone || 'Not provided'}</p>
                            <p><span class="font-medium">Email:</span> ${appointment.email || 'Not provided'}</p>
                        </div>
                    </div>

                    <!-- Appointment Details -->
                    <div>
                        <h3 class="text-lg font-semibold text-theme-text-primary mb-4 flex items-center">
                            <span class="material-icons mr-2">event</span>
                            Appointment Details
                        </h3>
                        <div class="bg-theme-bg-accent rounded-lg p-4 space-y-2">
                            <p><span class="font-medium">Service:</span> ${appointment.type}</p>
                            <p><span class="font-medium">Date & Time:</span> ${appointmentDate.toLocaleDateString()} at ${appointment.time} - ${appointment.endTime}</p>
                            <p><span class="font-medium">Duration:</span> ${appointment.duration} minutes</p>
                            <p><span class="font-medium">Calendar:</span> ${appointment.calendar}</p>
                            <p><span class="font-medium">Status:</span> 
                                <span class="status-badge ${appointment.canceled ? 'status-cancelled' : 'status-completed'}">
                                    ${appointment.canceled ? 'Cancelled' : 'Completed'}
                                </span>
                            </p>
                        </div>
                    </div>

                    <!-- Financial Information -->
                    ${price > 0 ? `
                        <div>
                            <h3 class="text-lg font-semibold text-theme-text-primary mb-4 flex items-center">
                                <span class="material-icons mr-2">payments</span>
                                Financial Information
                            </h3>
                            <div class="bg-theme-bg-accent rounded-lg p-4 space-y-2">
                                <p><span class="font-medium">Price:</span> $${price.toFixed(2)}</p>
                                <p><span class="font-medium">Amount Paid:</span> $${amountPaid.toFixed(2)}</p>
                                <p><span class="font-medium">Payment Status:</span> 
                                    <span class="${appointment.paid === 'yes' ? 'text-green-600' : 'text-red-600'} font-medium">
                                        ${appointment.paid === 'yes' ? 'Paid' : 'Unpaid'}
                                    </span>
                                </p>
                            </div>
                        </div>
                    ` : ''}

                    <!-- Additional Information -->
                    <div>
                        <h3 class="text-lg font-semibold text-theme-text-primary mb-4 flex items-center">
                            <span class="material-icons mr-2">info</span>
                            Additional Information
                        </h3>
                        <div class="bg-theme-bg-accent rounded-lg p-4 space-y-2">
                            <p><span class="font-medium">Appointment ID:</span> ${appointment.id}</p>
                            <p><span class="font-medium">Created:</span> ${createdDate.toLocaleDateString()} at ${createdDate.toLocaleTimeString()}</p>
                            ${appointment.notes ? `<p><span class="font-medium">Notes:</span> ${appointment.notes}</p>` : ''}
                            ${appointment.formsText ? `
                                <div>
                                    <p class="font-medium mb-2">Form Data:</p>
                                    <pre class="text-sm bg-theme-bg-primary p-3 rounded border">${appointment.formsText}</pre>
                                </div>
                            ` : ''}
                        </div>
                    </div>

                    <!-- Confirmation Links -->
                    <div>
                        <h3 class="text-lg font-semibold text-theme-text-primary mb-4 flex items-center">
                            <span class="material-icons mr-2">link</span>
                            Links
                        </h3>
                        <div class="bg-theme-bg-accent rounded-lg p-4 space-y-3">
                            <a href="${appointment.confirmationPage}" target="_blank" 
                               class="inline-flex items-center px-4 py-2 bg-theme-primary text-white rounded-lg hover:bg-theme-accent text-sm">
                                <span class="material-icons mr-2 text-sm">open_in_new</span>
                                View Confirmation Page
                            </a>
                            ${appointment.confirmationPagePaymentLink ? `
                                <a href="${appointment.confirmationPagePaymentLink}" target="_blank" 
                                   class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm ml-3">
                                    <span class="material-icons mr-2 text-sm">payment</span>
                                    Payment Link
                                </a>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Close appointment modal
        function closeAppointmentModal() {
            document.getElementById('appointmentModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Update statistics
        function updateStats() {
            const total = filteredAppointments.length;
            const completed = filteredAppointments.filter(apt => !apt.canceled).length;
            const cancelled = filteredAppointments.filter(apt => apt.canceled).length;

            document.getElementById('totalAppointments').textContent = total;
            document.getElementById('completedAppointments').textContent = completed;
            document.getElementById('cancelledAppointments').textContent = cancelled;
        }

        // Refresh appointments
        function refreshPastAppointments() {
            if (isLoading) return;
            
            isLoading = true;
            const refreshBtn = document.getElementById('refreshBtn');
            const refreshIcon = refreshBtn.querySelector('.material-icons');
            
            // Show loading state
            refreshIcon.style.animation = 'spin 1s linear infinite';
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('appointmentsContainer').style.display = 'none';
            
            // Simulate refresh (in real implementation, this would fetch fresh data)
            setTimeout(() => {
                loadDataFromLocalStorage();
                populateFilters();
                applyFilters();
                
                // Hide loading state
                refreshIcon.style.animation = '';
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('appointmentsContainer').style.display = 'grid';
                
                isLoading = false;
            }, 1500);
        }

        // Export past appointments
        function exportPastAppointments() {
            if (filteredAppointments.length === 0) {
                alert('No appointments to export');
                return;
            }

            const csvContent = generateCSVContent(filteredAppointments);
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `past_appointments_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Generate CSV content
        function generateCSVContent(appointments) {
            const headers = [
                'ID', 'Client Name', 'Phone', 'Email', 'Service', 'Date', 'Time', 
                'Duration', 'Calendar', 'Status', 'Price', 'Paid', 'Amount Paid', 'Created Date'
            ];

            const csvRows = [
                headers.join(','),
                ...appointments.map(apt => [
                    apt.id,
                    `"${apt.firstName} ${apt.lastName}"`,
                    apt.phone || '',
                    apt.email || '',
                    `"${apt.type}"`,
                    apt.date,
                    apt.time,
                    apt.duration,
                    `"${apt.calendar}"`,
                    apt.canceled ? 'Cancelled' : 'Completed',
                    apt.priceSold || apt.price || 0,
                    apt.paid,
                    apt.amountPaid || 0,
                    apt.dateCreated
                ].join(','))
            ];

            return csvRows.join('\n');
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            // Add mobile menu functionality if needed
            console.log('Mobile menu toggle');
        }

        // Open anonymous scheduling
        function openAnonymousScheduling() {
            const modal = document.getElementById('anonymousSchedulingModal');
            const iframe = document.getElementById('schedulingFrame');
            const loader = document.getElementById('schedulingLoader');
            
            // Show modal
            modal.classList.remove('hidden');
            
            // Show loader
            loader.style.display = 'flex';
            iframe.style.display = 'none';
            
            // In a real implementation, you would load the actual scheduling URL
            setTimeout(() => {
                iframe.src = 'https://app.acuityscheduling.com/schedule.php?owner=35757288';
                iframe.onload = () => {
                    loader.style.display = 'none';
                    iframe.style.display = 'block';
                };
            }, 1000);
            
            document.body.style.overflow = 'hidden';
        }

        // Close anonymous scheduling
        function closeAnonymousScheduling() {
            const modal = document.getElementById('anonymousSchedulingModal');
            const iframe = document.getElementById('schedulingFrame');
            
            modal.classList.add('hidden');
            iframe.src = '';
            document.body.style.overflow = 'auto';
        }

        // Show help modal
        function showHelpModal() {
            alert('Help & Information\n\nThis is the Past Appointments page where you can:\n\nâ€¢ View all completed and cancelled appointments\nâ€¢ Search appointments by client name, service, or contact details\nâ€¢ Filter appointments by date range, service type, status, or calendar\nâ€¢ Export appointment data to CSV\nâ€¢ View detailed appointment information\n\nFor more help, please contact support.');
        }

        // Global search functionality (for the header search)
        function initializeGlobalSearch() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        handleSearch(e);
                    }
                });
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            const appointmentModal = document.getElementById('appointmentModal');
            const schedulingModal = document.getElementById('anonymousSchedulingModal');
            
            if (e.target === appointmentModal) {
                closeAppointmentModal();
            }
            if (e.target === schedulingModal) {
                closeAnonymousScheduling();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Escape key to close modals
            if (e.key === 'Escape') {
                closeAppointmentModal();
                closeAnonymousScheduling();
            }
            
            // Ctrl/Cmd + R to refresh
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                refreshPastAppointments();
            }
        });

        // Add CSS for hiding scrollbars globally
        const style = document.createElement('style');
        style.textContent = `
            body, main, .overflow-y-auto, .overflow-auto {
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            body::-webkit-scrollbar, main::-webkit-scrollbar, .overflow-y-auto::-webkit-scrollbar, .overflow-auto::-webkit-scrollbar {
                display: none;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
